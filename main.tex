% !TEX TS-program = pdflatex
% =====================================================================
% Ergodic Metric Drift as a Path-Validity Engine on Finite Graphs,
% with Compile-Time Safety Contracts and a Murphy Clock
% Monolithic main.tex (full replacement; merged alt branch + extended write-up)
% =====================================================================
\documentclass[11pt]{article}

% ---------- Packages ----------
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb,mathtools,bm}
\usepackage{bbm}
\usepackage{xcolor}
\usepackage{microtype}
\usepackage{enumitem}
\usepackage{thmtools}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{booktabs}

\usepackage[colorlinks=true,linkcolor=blue!60!black,citecolor=teal!50!black,urlcolor=magenta!50!black]{hyperref}
\usepackage[nameinlink,capitalize,noabbrev]{cleveref}

% ---------- Bibliography ----------
\usepackage[backend=biber,style=authoryear,doi=false,isbn=false,url=false,maxcitenames=2,maxbibnames=9]{biblatex}
\addbibresource{refs.bib} % unified, global bibliography

% ---------- Theorem-like environments ----------
\declaretheorem[name=Theorem,numberwithin=section]{theorem}
\declaretheorem[name=Proposition,sibling=theorem]{proposition}
\declaretheorem[name=Lemma,sibling=theorem]{lemma}
\declaretheorem[name=Corollary,sibling=theorem]{corollary}
\declaretheorem[name=Definition,sibling=theorem]{definition}
\declaretheorem[name=Remark,sibling=theorem]{remark}
\declaretheorem[name=Example,sibling=theorem]{example}

% ---------- Macros ----------
\newcommand{\MT}{\mathrm{MT}}        % measure-theoretic
\newcommand{\CT}{\mathrm{CT}}        % compile-time
\newcommand{\E}{\mathbb{E}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\KL}{\mathrm{KL}}
\newcommand{\TV}{\mathrm{TV}}
\newcommand{\Wone}{W_1}
\newcommand{\dist}{\mathrm{dist}}
\newcommand{\supp}{\mathrm{supp}}
\newcommand{\Id}{\mathrm{Id}}
\newcommand{\Argmin}{\operatorname*{arg\,min}}
\newcommand{\Argmax}{\operatorname*{arg\,max}}
\newcommand{\inner}[2]{\left\langle #1,\,#2\right\rangle}
\newcommand{\1}{\mathbbm{1}}

\newcommand{\F}{\mathcal{F}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\Pcal}{\mathcal{P}}

% ---------- Title ----------
\title{\textbf{Ergodic Metric Drift as a Path-Validity Engine on Finite Graphs,\\
with Compile-Time Safety Contracts and a Murphy Clock}}
\author{Jacob Alexander Elliott}
\date{\today}

\begin{document}
\maketitle

\begin{abstract}
We merge two complementary layers for robust stochastic pipelines: (i) a \emph{compile-time} safety layer that enforces $\sigma$-measurable, support-respecting contracts on decision kernels and policies, closed under mixture/composition/pushforward and checkable by linear-time graph traversals in finite state spaces; and (ii) an \emph{Ergodic Metric Drift} (EMD) layer that acts as a \emph{path-validity engine} on finite graphs, converting elementary drift/minorization or contraction certificates into explicit-time bounds for the decay of ``bad-path'' mass. The layers are joined operationally by a \emph{Murphy clock}: a finite-time discovery schedule whose critical horizons are calibrated by spectral tilts on quotients and by classical ergodic constants. Claim-specific references tie contracts to standard measure-theoretic interfaces \parencite{Bogachev2007,AliprantisBorder2006}, EMD to Harris theory and minorization \parencite{MeynTweedie2009,Nummelin1984,RobertsRosenthal2004}, contraction proxies \parencite{LevinPeresWilmer2009,Seneta2006}, curvature \parencite{Ollivier2009,JoulinOllivier2010}, and LDP/spectral tooling \parencite{DemboZeitouni1998}. Interoperability with FI/CRLB transport \parencite{Blackwell1953,AmariNagaoka2000,Cencov1982}, Quotient Flow Invariants \parencite{elliott2025qfi}, Flow Centrality \parencite{elliott2025flow,Freeman1977,Newman2005}, Drift Validity \parencite{elliott2025drift}, and Murphy budgeting \parencite{elliott2025pmb} is explicit.
\end{abstract}

% =========================
\section{Introduction}\label{sec:intro}
% =========================
\paragraph{Engine perspective (finite graphs).}
On a finite directed graph $G=(V,E)$ with row-stochastic kernel $P$, fix a \emph{valid} set $S\subseteq V$ and write $B=S^c$. An \emph{EMD certificate} supplies a potential $V:V\to\R_{\ge 0}$ with $V|_S=0$ and a quantified drift inequality outside a small set; together with a minorization or a contraction coefficient bound, the certificate yields explicit-time decay for bad-path mass and hitting-time tails, with geometric or subgeometric rates depending on the hypothesis class \parencite{MeynTweedie2009,Nummelin1984,RobertsRosenthal2004,DoucFortMoulines2004,JarnerRoberts2002}.

\paragraph{Compile-time layer (measure-theoretic contracts).}
To avoid brittle run-time checks, we expose \emph{$\sigma$-contracts} at the interface of kernels and policies: safety sets are measurable, admissible actions are measurable and support-respecting, and allowed transitions do not leak mass into hazards. These contracts are preserved by the standard constructors (mixture, composition, pushforward), and in finite state spaces reduce to forward-closure under allowed edges, checkable by BFS/DFS \parencite{Bogachev2007,AliprantisBorder2006,Cormen2009}.

\paragraph{Murphy clock (finite-time scheduling).}
If a configuration can happen in an ergodic system, the Murphy clock turns existential reachability into a \emph{finite-time} guarantee: with probability $\ge 1-\beta$ a witness appears by time
\(
L_c\sim \frac{\log(1/\beta)}{\alpha\,I(\theta)},
\)
where $\alpha$ is an information price and $I$ is a convex rate computed from a tilted spectral radius on the quotient \parencite{DemboZeitouni1998,elliott2025qfi,elliott2025pmb}. This couples naturally to EMD constants and to Flow Central bottleneck diagnostics \parencite{elliott2025flow,Freeman1977,Newman2005}.

\paragraph{Contributions.}
\begin{enumerate}[leftmargin=1.25em]
\item A \emph{unified} contract language (hard and soft) with closure properties and a finite-state reduction (BFS/DFS) that compiles safety at design time \parencite{Bogachev2007,AliprantisBorder2006,Cormen2009}.
\item An \emph{EMD cookbook} of certifiers (drift+minorization, Dobrushin/TV, conductance/gap, curvature, path coupling) with explicit constants and nonreversible lift plug-ins \parencite{MeynTweedie2009,LevinPeresWilmer2009,Seneta2006,Ollivier2009,JoulinOllivier2010,LawlerSokal1988,BubleyDyer1997,ChenLovaszPak1999,DiaconisHolmesNeal2000}.
\item A \emph{Murphy clock} that fuses EMD constants with spectral–LDP rates on quotients, producing schedulable discovery targets \parencite{DemboZeitouni1998,elliott2025qfi,elliott2025pmb}.
\item Interop with FI/CRLB transport and sufficiency \parencite{Blackwell1953,AmariNagaoka2000,Cencov1982}, Drift Validity \parencite{elliott2025drift}, and Flow Centrality \parencite{elliott2025flow}.
\end{enumerate}

% =========================
\section{Measure-theoretic contracts}\label{sec:contracts}
% =========================
Let $(\Omega,\F)$ be standard Borel, $(\A,\mathcal{A})$ Borel actions. A controlled kernel $K:\Omega\times\A\to \Pcal(\Omega)$ is measurable in both coordinates; a policy $\pi:\Omega\to \Pcal(\A)$ is measurable with $\supp(\pi(\cdot\mid \omega))\subseteq \A$ \parencite{Bogachev2007,AliprantisBorder2006,MeynTweedie2009}. Let $S\in\F$ be \emph{safe}, $H=S^c$ \emph{hazard}, and $A_{\text{safe}}(\omega)\subseteq \A$ measurable.

\begin{definition}[$\sigma$-safety tiers]
For $\omega\in S$:
\begin{itemize}[leftmargin=1.1em]
\item \textbf{R-$\sigma$} (robust): $K(\omega,a;H)=0$ for all $a\in\A$.
\item \textbf{I-$\sigma$} (interface): $K(\omega,a;H)=0$ for all $a\in A_{\text{safe}}(\omega)$.
\item \textbf{P-$\sigma$} (policy): $K(\omega,a;H)=0$ for all $a\in \supp(\pi(\cdot\mid\omega))$.
\end{itemize}
Then $\text{R-}\sigma\Rightarrow \text{I-}\sigma\Rightarrow \text{P-}\sigma$.
\end{definition}

\paragraph{Closure.}
I-$\sigma$ is preserved by measurable mixtures, composition $K_2\circ K_1$, and measurable pushforwards (naturality of image measures) \parencite{Bogachev2007}. A lightweight static analyzer checks measurability, support, and closure conditions at compile time; see also typed/graded effects \parencite{elliott2025contracts,elliott2025graded}.

\subsection{Finite-state specialization}\label{sec:finite}
On finite $V$, define allowed edges
\[
E=\{(i,j): \exists a\in A_{\text{safe}}(i)\ \text{s.t.}\ K(i,a;\{j\})>0\}.
\]
I-$\sigma$ $\iff$ $S$ is forward-closed in $(V,E)$; BFS/DFS checks in $O(|V|+|E|)$ \parencite[Ch.~22]{Cormen2009}. For P-$\sigma$, restrict to edges supported by $\pi$.

\subsection{Soft contracts}\label{sec:soft}
Soft contracts bound violation probabilities via spectral–LDP envelopes on quotients:
\[
\Prob(\text{violate by time }T)\ \le\ \exp\{-\alpha\, I(\theta)\,T\} + \varepsilon_{\text{lump}}/\gamma,
\]
where $I$ is the Legendre dual of a tilted spectral radius, $\varepsilon_{\text{lump}}$ a lumpability dispersion, and $\gamma$ a spectral gap \parencite{DemboZeitouni1998,elliott2025qfi}. Risk–price tradeoffs may also be expressed with CVaR \parencite{RockafellarUryasev2000}.

% =========================
\section{EMD: drift, minorization, and contraction}\label{sec:emd}
% =========================
Let $G=(V,E)$, $P$ a row-stochastic kernel on $V$. Fix $S\subseteq V$ and $B=S^c$. Write $\tau_S=\inf\{t\ge 0: X_t\in S\}$.

\paragraph{Potentials and small sets.}
Choose $V:V\to[0,\infty)$ with $V|_S=0$. A set $C\subseteq V$ is \emph{small} if $\exists t_\star,\beta,\nu$ s.t.\ $P^{t_\star}(x,\cdot)\ge \beta\,\nu(\cdot)$ for all $x\in C$ \parencite{Nummelin1984,RobertsRosenthal2004}. On finite graphs, $(t_\star,\beta,\nu)$ can be found algorithmically (\Cref{alg:minor}).

\begin{lemma}[Uniform minorization on $C$]\label{lem:minor}
If $P^{t_\star}(x,y)\ge \beta$ for all $x,y\in C$, then with $\nu=\mathrm{Unif}(C)$, $P^{t_\star}(x,\cdot)\ge \beta\,|C|\,\nu(\cdot)$ for all $x\in C$.
\end{lemma}

\begin{theorem}[Harris drift $\Rightarrow$ geometric decay]\label{thm:harris}
Suppose there exist $V\ge 0$, $\lambda\in(0,1)$, $b<\infty$, and a small set $C$ with
\[
\E\!\left[V(X_{t+1})\mid X_t=x\right]\ \le\ \lambda V(x)+b\,\1\{x\in C\}.
\]
Then $\exists M<\infty$, $\rho\in(0,1)$ such that for any start
\(
\|P^t(x,\cdot)-\pi\|_{\TV}\le M\rho^t.
\)
On finite graphs, $(M,\rho)$ are explicit from $(\lambda,b)$ and minorization constants \parencite{MeynTweedie2009,Baxendale2005,RobertsRosenthal2004}.
\end{theorem}

\paragraph{Dobrushin/TV contraction.}
The Dobrushin coefficient $\alpha(P):=\sup_{x\neq y}\tfrac12\sum_{z}|P(x,z)-P(y,z)|$ controls \(\TV\) contraction: $\|\mu P-\nu P\|_{\TV}\le \alpha(P)\|\mu-\nu\|_{\TV}$ \parencite[Ch.~4]{LevinPeresWilmer2009,Seneta2006}. If $\alpha(P)\le 1-\gamma$, then for $p_t=\Prob(X_t\in B)$ one has $p_t\le (1-\gamma)^t p_0$; if $S$ is absorbing, $\Prob(\tau_S>t)\le (1-\gamma)^t$.

\paragraph{Curvature.}
On a metric $d$, Ollivier’s coarse Ricci curvature $\kappa$ yields $\Wone(\mu P,\nu P)\le (1-\kappa)\Wone(\mu,\nu)$ \parencite{Ollivier2009}. With $d(x,S)$ as cost,
\(
\E[d(X_t,S)]\le (1-\kappa)^t\,\E[d(X_0,S)],
\)
and Markov’s inequality converts this to a tail bound for $\tau_S$; concentration and deviation bounds follow \parencite{JoulinOllivier2010}.

\paragraph{Subgeometric drift.}
If $PV\le V-\phi(V)+b\,\1_C$ with $\phi$ concave, increasing, and $\int^\infty \frac{du}{\phi(u)}=\infty$, then subgeometric rates are explicit through the inverse of $H_\phi(t)=\int_1^t \frac{du}{\phi(u)}$ \parencite{DoucFortMoulines2004,JarnerRoberts2002}.

% =========================
\section{Spectral proxies, nonreversible lifts, and coupling}\label{sec:spectral}
% =========================
\paragraph{Conductance and gap.}
For reversible chains, conductance $\Phi$ supplies $\mathrm{gap}\gtrsim \Phi^2$; this translates directly to geometric decay for occupancy/hitting tails up to constants \parencite{LawlerSokal1988,LevinPeresWilmer2009}.

\paragraph{Nonreversible lift plugins.}
Momentum lifts and skew-detailed-balance samplers can enlarge effective gaps without changing stationarity \parencite{ChenLovaszPak1999,DiaconisHolmesNeal2000}. EMD inequalities transfer componentwise since they depend on forward transitions.

\paragraph{Path coupling.}
If neighbors contract in expectation for a path-extended metric, mixing is geometric at that rate \parencite{BubleyDyer1997}. Taking $d(\cdot,S)$ yields direct bounds for $\Prob(\tau_S>t)$ via coalescence.

% =========================
\section{Murphy clock: schedules from EMD + LDP}\label{sec:murphy}
% =========================
The clock targets a failure probability $\beta$ and information price $\alpha$:
\[
L_c(\theta;\alpha,\beta)\ \approx\ \frac{\log(1/\beta)}{\alpha\, I(\theta)}.
\]
Two derivations:
\begin{enumerate}[leftmargin=1.25em]
\item \textbf{Minorization:} Under Doeblin’s condition $P^h\ge \epsilon \nu$, block hits of $S$ are dominated by Bernoulli$(\epsilon \nu(S))$, producing geometric tails with explicit constants \parencite[Ch.~16]{MeynTweedie2009}. Aggregation to quotients perturbs constants by lumpability/gap terms \parencite{elliott2025qfi}.
\item \textbf{TV mixing:} If $\|P^t(\omega,\cdot)-\eta\|_{\TV}\le \delta(t)$, occupancy concentrates near $\eta(S)$ after a mixing window; Chernoff/LDP bounds via the spectral CGF $\Lambda(t)$ on the quotient yield the stated schedule \parencite{LevinPeresWilmer2009,DemboZeitouni1998,elliott2025qfi}.
\end{enumerate}
Parallel Murphy budgeting prioritizes probes along Flow-Central bottlenecks and reduces wall-clock in the rare-event regime \parencite{elliott2025pmb,elliott2025flow,Freeman1977,Newman2005}.

% =========================
\section{Interop: FI/CRLB transport, quotients, and flow}\label{sec:interop}
% =========================
Idiom projections that are sufficient in Blackwell’s sense preserve FI exactly; otherwise FI contracts and CRLB widens \parencite{Blackwell1953,AmariNagaoka2000,Cencov1982}. On quotients, spectral tilts and rate functions are invariant to measurable isomorphisms, providing stable Murphy horizons \parencite{elliott2025qfi,DemboZeitouni1998}. Flow Centrality pinpoints fragile channels where forbidding nodes/edges inflates tilted cost, explaining FI curvature spikes and schedule sensitivity \parencite{elliott2025flow,Freeman1977,Newman2005}.

% =========================
\section{Case studies}\label{sec:cases}
% =========================
\paragraph{BA--FRC (interface-$\sigma$).}
Interface contracts exclude hazard actions at the role boundary; EMD with a distance-to-target potential gives geometric tails with constants inferred from a small set near the “doorway.” Murphy horizons and observed latencies align up to constant factors; discrepancies coincide with large lumpability error relative to the spectral gap \parencite{elliott2025bafrc,elliott2025qfi,LevinPeresWilmer2009}.

\paragraph{Lazy expander baseline.}
On a lazy $d$-regular expander with spectral gap $\gamma>0$ and a target of stationary mass $h$, mixing is $O(\log|V|)$ and Doeblin minorization yields $\E[\tau_S]=\Theta(\log|V|/h)$ with geometric tails \parencite{HooryLinialWigderson2006,LevinPeresWilmer2009}.

% =========================
\section{Implementation: analyzers and certificates}\label{sec:impl}
% =========================
\paragraph{Static analyzer.}
Checks: (i) measurability of $S$ and $A_{\text{safe}}$; (ii) $\supp(\pi)\subseteq A_{\text{safe}}$; (iii) closure of contracts under constructors; (iv) forward-closure by BFS/DFS in finite spaces \parencite{Cormen2009}. In constrained MDPs, admissibility propagates through options with guarantees preserved \parencite{Puterman1994,Altman1999}.

\paragraph{Certificate algorithms.}
\Cref{alg:minor} searches minorization; \Cref{alg:dobrushin} computes Dobrushin coefficients; curvature scanning computes $\kappa(x,y)$ per edge \parencite{Ollivier2009}.

\begin{algorithm}[h]
\caption{Uniform minorization on a candidate small set $C$}\label{alg:minor}
\begin{algorithmic}[1]
\Require Kernel $P$, set $C\subseteq V$, horizon $t_\star$
\State Compute $M(u,v):=P^{t_\star}(u,v)$ for $u,v\in C$
\State $\beta \gets \min_{u\in C}\sum_{v\in C} M(u,v)/|C|$
\If{$\beta>0$} \State \textbf{return} $(t_\star,\beta,\nu=\mathrm{Unif}(C))$ \Comment{$C$ is small by \Cref{lem:minor}}
\Else \State \textbf{return} fail
\EndIf
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[h]
\caption{Dobrushin coefficient $\alpha(P)$}\label{alg:dobrushin}
\begin{algorithmic}[1]
\Require Kernel $P$ on $V$
\State $\alpha\gets 0$
\For{$x\in V$}
  \For{$y\in V$}
    \State $\alpha\gets \max\bigl(\alpha,\tfrac12\sum_{z\in V}|P(x,z)-P(y,z)|\bigr)$
  \EndFor
\EndFor
\State \textbf{return} $\alpha$
\end{algorithmic}
\end{algorithm}

% =========================
\section{Proof details and constants}\label{sec:proofs}
% =========================
\paragraph{Composition/pushforward for $\sigma$-contracts.}
Linearity/monotonicity of measures and measurability of composition/pushforward yield closure; Fubini/Tonelli justifies integrals \parencite{Bogachev2007}.

\paragraph{Baxendale constants.}
Under drift $PV\le \lambda V + b\,\1_C$ and minorization $P^{t_\star}\ge \beta \nu$ on $C$, one can take
\[
\epsilon:=\frac{(1-\lambda)\beta}{2(1-\lambda+b\,\nu(V))},\quad
\rho:=1-\epsilon/t_\star,\quad
M:=\tfrac{2}{\epsilon}\bigl(1+\tfrac{b}{1-\lambda}\bigr),
\]
so that $\|P^t-\pi\|_{\TV}\le M\rho^t$ \parencite{Baxendale2005}. On finite graphs $\nu(V)\le \max_C V$.

\paragraph{Curvature-to-tail.}
If $\Wone(\mu P,\nu P)\le (1-\kappa)\Wone(\mu,\nu)$ and $d(x,S)\ge \underline{d}>0$ on $B$, then
\(
\Prob(\tau_S>t)\le \tfrac{(1-\kappa)^t\,\E[d(X_0,S)]}{\underline{d}}
\) \parencite{Ollivier2009,JoulinOllivier2010}.

% =========================
\section{Limitations}\label{sec:limits}
% =========================
Finite graphs avoid petite-set subtleties; continuous-state variants require Lyapunov/petite conditions and careful numerics \parencite{MeynTweedie2009,HairerMattingly2011}. When lumpability error is comparable to the spectral gap, quotient schedules degrade. EMD certifies decay, not optimality; fairness/utility layers must be added separately \parencite{Altman1999,Puterman1994}.

% =========================
\section{Conclusion}\label{sec:conclusion}
% =========================
The compile-time layer makes safety \emph{static} and compositional; the EMD layer makes path validity \emph{operational} with explicit constants; the Murphy clock makes discovery \emph{schedulable}. The triad turns structural checks and simple inequalities into wall-clock guarantees, and it plugs cleanly into FI/CRLB transport, QFI on quotients, and Flow Central routing.

\printbibliography

\end{document}