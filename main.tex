% !TeX program = pdflatex
% !BIB program = bibtex
\documentclass[11pt]{article}
\usepackage[backend=biber,style=authoryear,doi=true,isbn=false,url=false,giveninits=true,maxcitenames=2]{biblatex}
\addbibresource{refs.bib}
% Encoding & fonts (robust UTF-8 punctuation under pdfLaTeX)
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{biblatex}

% Layout & math
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb,mathtools}
\usepackage{dsfont,bm}
\usepackage{tikz-cd}
\usepackage{enumitem}
\usepackage{microtype}

% Links & cross-references
\usepackage[hidelinks]{hyperref}
\usepackage[nameinlink,capitalise,noabbrev]{cleveref}

\title{\textbf{Ergodic Metric Drift as a Path Validity Engine}\\[0.25em]\large Finite Graphs}
\author{}
\date{\today}

% --- Theorem setup ---
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{example}[theorem]{Example}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{notation}[theorem]{Notation}

% --- Macros ---
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\KL}{\mathsf{KL}}
\DeclareMathOperator{\TV}{\mathsf{TV}}
\DeclareMathOperator{\Var}{\mathsf{Var}}
\DeclareMathOperator{\Cov}{\mathsf{Cov}}
\DeclareMathOperator{\diag}{\mathsf{diag}}
\DeclareMathOperator{\supp}{\mathsf{supp}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\1}{\mathds{1}}

\newcommand{\U}{\mathcal{U}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\A}{\mathcal{A}}

\newcommand{\Free}{\mathsf{F}}
\newcommand{\EP}{\sigma}
\newcommand{\Budget}{\mathsf{B}}
\newcommand{\Cost}{\mathsf{Cost}}
\newcommand{\Gain}{\mathsf{IG}}

% Cross-series shorthands
\newcommand{\Proj}{\mathsf{Proj}}
\newcommand{\Nec}{\Box}
\newcommand{\Poss}{\Diamond}
\newcommand{\FlowCent}{\mathsf{FC}}
\newcommand{\QFI}{\mathsf{QFI}}

\begin{document}
\maketitle

\begin{abstract}
We develop \emph{ergodic metric drift} as a path validity engine for inference on finite graphs: a Foster--Lyapunov drift with a small-set/minorization guarantee yields geometric ergodicity, explicit mixing bounds, and finite hitting-time tails. These certify eventual coverage (\emph{path validity}) of inference procedures that transport probability mass across the graph. The skeleton is classical---drift \& minorization imply geometric ergodicity \cite{MeynTweedie2009,RobertsRosenthal2004,Nummelin1984}---but tuned to the idiom-crossing runtime: compatibility with idiom projections, graded-effect contracts, QFI alignment, and the Non-Reversibility Selector (NRS). We provide computational certificates (Dobrushin coefficient; TV contraction; spectral-gap proxies) and constructive couplings (path coupling and exact sampling) \cite{Seneta2006,LevinPeresWilmer2009,BubleyDyer1997,ProppWilson1996}. The engine integrates with \emph{Parallel Murphy Budgeting}, \emph{Idiom Projections}, \emph{Measure-Theoretic Flow Centrality}, and \emph{Large A}, while satisfying the selector conditions of \emph{NRS} \cite{MurphyBudget2025,IdiomProjections2025,FlowCentrality2025,GradedEffects2025,NRSinPrep2025}.
\end{abstract}

\section{Introduction}
Inference over finite graphs---random walks, lazy diffusions, controlled kernels---underlies the runtime's transport layer. \emph{Ergodic metric drift} packages the minimal conditions for eventual coverage and stable learning: a Lyapunov descent outside a small set and a minorization on that set. The reward is robust: total-variation (TV) convergence at geometric rate, concentration of hitting times, and algorithmic levers like path coupling \cite{MeynTweedie2009,RobertsRosenthal2004,BubleyDyer1997}.

\paragraph{Series placement.}
This engine is the coverage certificate supporting \emph{QFI} ascent and \emph{flow centrality} measures, schedulability under \emph{Parallel Murphy Budgeting}, and type-safety in \emph{Large~A}. It aligns with the \emph{NRS} claim that Gibbs asymmetry is epistemically fit: non-reversibility strengthens descent and prevents stalling cycles (\cite{NRSinPrep2025}; see selector equivalences there).

\subsection{Contributions}
\begin{enumerate}[label=(C\arabic*)]
\item A finite-graph formulation of ergodic metric drift with small-set/minorization leading to geometric ergodicity (\cref{thm:drift_minorization_geometric}); cf.\ \cite{MeynTweedie2009,RobertsRosenthal2004,Nummelin1984}.
\item TV-contraction bounds via the Dobrushin coefficient and spectral proxies (\cref{prop:dobrushin}, \cref{prop:spectral}); cf.\ \cite{Seneta2006,LevinPeresWilmer2009}.
\item Path-coupling templates for rapid mixing on structured graphs (\cref{thm:path_coupling}); cf.\ \cite{BubleyDyer1997}.
\item Computational certificates: implementable tests for drift, minorization, and mixing in Mathematica; exact sampling connections \cite{ProppWilson1996}.
\end{enumerate}

\section{Preliminaries}
Let $G=(V,E)$ be a finite directed graph (loops allowed). A \emph{Markov kernel} $P$ on $V$ is row-stochastic with $P(x,y)>0$ implying $(x\to y)\in E\cup \{(x,x)\}$. For $\mu,\nu$ on $V$, $\TV(\mu,\nu)=\tfrac12\sum_{x\in V}|\mu(x)-\nu(x)|$ \cite{LevinPeresWilmer2009}. A stationary distribution $\pi$ satisfies $\pi P=\pi$. We write $P^t$ for $t$-step kernels.

\begin{definition}[Foster--Lyapunov drift and small set]
Fix $V:V\to[1,\infty)$ and constants $\lambda\in[0,1)$, $b<\infty$. A kernel $P$ satisfies a \emph{(geometric) drift condition} if
\[
\EE[V(X_{t+1})\mid X_t=x]\le \lambda V(x)+b\quad\text{for all }x\in V.
\]
A set $C\subseteq V$ is \emph{small} if there exists $m\in\NN$, $\epsilon>0$, and a probability measure $\nu$ such that $P^m(x,\cdot)\ge \epsilon\,\nu(\cdot)$ for all $x\in C$ (\emph{minorization}).
\end{definition}

\begin{remark}
On finite graphs, aperiodicity and irreducibility guarantee geometric ergodicity even without explicit $V$; we retain $V$ because it interfaces with program budgets and graded effects in the runtime, and because it extends to infinite-state settings elsewhere in the series \cite{MeynTweedie2009}.
\end{remark}

\section{Drift + minorization $\Rightarrow$ geometric ergodicity}
\begin{theorem}[Geometric ergodicity via drift and small set]\label{thm:drift_minorization_geometric}
Suppose $P$ is $\pi$-irreducible and aperiodic. If $P$ satisfies a geometric drift condition with small set $C$, then there exist $R<\infty$ and $\rho\in(0,1)$ such that for all $x\in V$ and $t\in\NN$,
\[
\TV\!\big(\delta_x P^t,\pi\big)\le R\,V(x)\,\rho^t.
\]
\textit{Claim-specific citations:} This is a standard Foster--Lyapunov + minorization conclusion; see \cite[Thm.~15.0.1]{MeynTweedie2009} and the survey \cite[Sec.~2]{RobertsRosenthal2004}. Small-set/minorization is treated classically in \cite{Nummelin1984}.
\end{theorem}

\begin{proof}[Proof sketch]
The drift condition yields a regeneration structure via Nummelin splitting; the small set provides a minorization that anchors regeneration. Geometric tails for regeneration times induce the bound, with constants computed from $(\lambda,b,\epsilon,m)$; see \cite{MeynTweedie2009,Nummelin1984,RobertsRosenthal2004}.
\end{proof}

\subsection{Dobrushin coefficient and TV contraction}
\begin{definition}[Dobrushinâ€™s ergodicity coefficient]
$\alpha(P)=1-\sup_{x,x'}\tfrac12\sum_y|P(x,y)-P(x',y)|$. Then for any distributions $\mu,\nu$,
\[
\TV(\mu P,\nu P)\le (1-\alpha(P))\,\TV(\mu,\nu).
\]
\end{definition}

\begin{proposition}[One-step contraction]\label{prop:dobrushin}
If $\alpha(P)>0$, then $\TV(\mu P^t,\nu P^t)\le (1-\alpha(P))^t \,\TV(\mu,\nu)$.
\textit{Claim-specific citations:} Standard coefficient-of-ergodicity bound \cite[Ch.~4]{Seneta2006}; see also \cite[Ch.~4]{LevinPeresWilmer2009}.
\end{proposition}

\subsection{Spectral proxies on finite graphs}
\begin{proposition}[Spectral gap proxy]\label{prop:spectral}
If $P$ is reversible w.r.t.\ $\pi$, then
\[
\TV(\delta_x P^t,\pi)\le \tfrac12 \sqrt{\frac{1-\pi_{\min}}{\pi_{\min}}}\,\lambda_\star^t
\]
where $\lambda_\star$ is the second-largest eigenvalue modulus of $P$ and $\pi_{\min}=\min_x\pi(x)$.
\textit{Claim-specific citations:} Textbook spectral bounds \cite[Ch.~12]{LevinPeresWilmer2009}.
\end{proposition}

\section{Path coupling and exact sampling}
\begin{theorem}[Path coupling]\label{thm:path_coupling}
Let $d$ be a path metric on $V$ and suppose a one-step coupling $\mathcal{C}$ satisfies
\[
\EE[d(X_1,Y_1)\mid X_0=x,Y_0=y]\le \beta\,d(x,y)
\]
for all adjacent pairs with $\beta<1$. Then $\TV(\delta_x P^t,\delta_y P^t)\le \EE[d(X_t,Y_t)]\le \beta^t d(x,y)$, hence geometric mixing.
\textit{Claim-specific citations:} \cite{BubleyDyer1997,LevinPeresWilmer2009}.
\end{theorem}

\begin{remark}[Exact sampling]
Under a monotone or dominated coupling scheme, \emph{coupling from the past} (CFTP) gives perfect samples from $\pi$ \cite{ProppWilson1996}. This plugs into the engine as a certification tool when the coupling is feasible.
\end{remark}

\section{Path validity engine}
We define \emph{path validity} as eventual coverage with quantitative tails.

\begin{definition}[Path validity]
A kernel $P$ has \emph{path validity} if for every target set $G\subseteq V$, the hitting time $\tau_G=\inf\{t\ge 0:X_t\in G\}$ satisfies $\sup_{x\in V}\EE_x[\tau_G]<\infty$ and $\sup_{x\in V}\PP_x(\tau_G>t)\le C\,\rho^t$ for some $C<\infty$, $\rho\in(0,1)$.
\end{definition}

\begin{proposition}[Drift/minorization certify path validity]
Under the hypotheses of \cref{thm:drift_minorization_geometric}, path validity holds with constants depending on $(\lambda,b,\epsilon,m)$ and $G$ through minorization on $C\cup G$.
\textit{Claim-specific citations:} Hitting-time tails from geometric ergodicity and regeneration \cite{MeynTweedie2009,RobertsRosenthal2004}.
\end{proposition}

\section{Runtime alignment}
\paragraph{NRS selector.} Gibbs asymmetry ($\EP>0$) strengthens strict Lyapunov descent and eliminates reversible cycles; this interacts with the drift engine by lowering effective $\rho$ and tightening hitting-time tails (see \cite{NRSinPrep2025} for selector equivalences).

\paragraph{Murphy budgeting.} Mixing-time truncations provide safe horizons; expected gain under budget aligns with the drift potential $\Free$ and centrality structure, connecting to $(1-1/e)$ scheduling guarantees \cite{MurphyBudget2025,LevinPeresWilmer2009}.

\paragraph{Contracts.} Graded effects index cost/risk; drift constants $(\lambda,b)$ and minorization $(m,\epsilon)$ become type indices used to reject unschedulable kernels at compile time \cite{GradedEffects2025}.

\section{Worked examples}
\begin{example}[Lazy walk on a cycle]
On $C_n$ with lazy walk $P=\tfrac12 I+\tfrac14(\text{left}+\text{right})$, reversibility holds and the spectral gap is $1-\cos\frac{2\pi}{n}$ \cite{LevinPeresWilmer2009}. Path coupling using Hamming distance yields an equivalent bound \cite{BubleyDyer1997}.
\end{example}

\begin{example}[Directed star with stickiness]
Let $V=\{0,1,\dots,k\}$ with edges $i\to 0$ and $0\to i$; add self-loops of weight $\gamma\in(0,1)$ at $0$. Minorization on $\{0\}$ is immediate; a piecewise-constant $V$ verifies drift, yielding geometric ergodicity.
\end{example}

\section*{Acknowledgments and cross-references}
This paper interlocks with \emph{QFI}, \emph{Idiom Projections}, \emph{Modal Shell}, \emph{Parallel Murphy Budgeting}, \emph{Measureâ€‘Theoretic Flow Centrality}, \emph{Large A}, and \emph{NRS} \cite{QFI2025,IdiomProjections2025,ModalShell2025,MurphyBudget2025,FlowCentrality2025,GradedEffects2025,NRSinPrep2025}.

% --- Bibliography: BibTeX path set to ../bib/main.bib ---
% TEMP: \nocite{*} forces printing even if a key is never cited in-text.
\nocite{*}
\printbibliography
\end{document}